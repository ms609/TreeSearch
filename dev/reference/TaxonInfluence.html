<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Rank taxa by their influence on phylogenetic results — TaxonInfluence • TreeSearch</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Rank taxa by their influence on phylogenetic results — TaxonInfluence"><meta name="description" content="TaxonInfluence() ranks taxa according to their influence on the most
parsimonious topology."><meta property="og:description" content="TaxonInfluence() ranks taxa according to their influence on the most
parsimonious topology."><meta name="robots" content="noindex"><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-V9DV1LS35J"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-V9DV1LS35J');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">TreeSearch</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.6.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Getting started</h6></li>
    <li><a class="dropdown-item" href="../articles/getting-started.html">Getting started: Installing R and TreeSearch</a></li>
    <li><a class="dropdown-item" href="../articles/tree-search.html">Getting started: Simple tree searches</a></li>
    <li><a class="dropdown-item" href="../articles/tree-space.html">Getting started: Exploring tree space</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Advanced use</h6></li>
    <li><a class="dropdown-item" href="../articles/profile-scores.html">Profile parsimony</a></li>
    <li><a class="dropdown-item" href="../articles/profile.html">Tree search with Profile parsimony</a></li>
    <li><a class="dropdown-item" href="../articles/custom.html">Tree search with custom optimality criteria</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ms609/TreeSearch/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Rank taxa by their influence on phylogenetic results</h1>
      <small class="dont-index">Source: <a href="https://github.com/ms609/TreeSearch/blob/master/R/TaxonInfluence.R" class="external-link"><code>R/TaxonInfluence.R</code></a></small>
      <div class="d-none name"><code>TaxonInfluence.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>TaxonInfluence()</code> ranks taxa according to their influence on the most
parsimonious topology.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">TaxonInfluence</span><span class="op">(</span></span>
<span>  <span class="va">dataset</span>,</span>
<span>  tree <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Distance <span class="op">=</span> <span class="va">ClusteringInfoDistance</span>,</span>
<span>  calcWeighted <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  savePath <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  useCache <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbosity <span class="op">=</span> <span class="fl">3L</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-dataset">dataset<a class="anchor" aria-label="anchor" href="#arg-dataset"></a></dt>
<dd><p>A phylogenetic data matrix of <span class="pkg">phangorn</span> class
<code>phyDat</code>, whose names correspond to the labels of any accompanying tree.
Perhaps load into R using <code><a href="https://ms609.github.io/TreeTools/reference/ReadCharacters.html" class="external-link">ReadAsPhyDat</a></code>.
Additive (ordered) characters can be handled using
<code><a href="https://ms609.github.io/TreeTools/reference/Decompose.html" class="external-link">Decompose</a></code>.</p></dd>


<dt id="arg-tree">tree<a class="anchor" aria-label="anchor" href="#arg-tree"></a></dt>
<dd><p>Optimal tree or summary tree (of class "phylo") or list of trees
(of class "list" or "multiPhylo") against which results should be evaluated.
If <code>NULL</code>, an optimal tree will be sought using parsimony search with
the parameters provided in <code>...</code>.</p></dd>


<dt id="arg-distance">Distance<a class="anchor" aria-label="anchor" href="#arg-distance"></a></dt>
<dd><p>Function to calculate tree distance; default:
<code><a href="https://ms609.github.io/TreeDist/reference/TreeDistance.html" class="external-link">ClusteringInfoDistance()</a></code>.</p></dd>


<dt id="arg-calcweighted">calcWeighted<a class="anchor" aria-label="anchor" href="#arg-calcweighted"></a></dt>
<dd><p>Logical specifying whether to compute the
distance-weighted mean value.</p></dd>


<dt id="arg-savepath">savePath<a class="anchor" aria-label="anchor" href="#arg-savepath"></a></dt>
<dd><p>Character giving prefix of path to which reduced trees will
be saved (with <code><a href="https://rdrr.io/pkg/ape/man/write.nexus.html" class="external-link">write.nexus()</a></code>).
File names will follow the pattern
<code>paste0(savePath, droppedTaxonName, ".nex")</code>; <code>savePath</code> should thus contain
a trailing <code>/</code> if writing to a directory, which will be created if it does
not exist.  Special characters will be removed from leaf labels when
creating the file path (using
<code><a href="https://fs.r-lib.org/reference/path_sanitize.html" class="external-link">path_sanitize()</a></code>).
If <code>NULL</code>, computed trees will not be saved.</p></dd>


<dt id="arg-usecache">useCache<a class="anchor" aria-label="anchor" href="#arg-usecache"></a></dt>
<dd><p>Logical vector; if <code>TRUE</code>, previous tree search results will
be loaded from the location given by <code>savePath</code>, instead of running a fresh
search with the specified dataset and parameters.</p></dd>


<dt id="arg-verbosity-">verbosity, ...<a class="anchor" aria-label="anchor" href="#arg-verbosity-"></a></dt>
<dd><p>Parameters for <code><a href="MaximizeParsimony.html">MaximizeParsimony()</a></code>.
Tree search will be conducted using <code>tree</code> as a starting tree.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>TaxonInfluence()</code> returns a matrix listing the phylogenetic
influence of each taxon, measured in the units of the chosen tree distance
metric (default = bits).
Columns denote taxa; rows denote the maximum, distance-weighted mean,
and minimum distance between optimal tree sets.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>TaxonInfluence()</code> follows the approach of
Mariadassou et al. (2012)
 in repeating tree search
whilst leaving each taxon in turn out of the analysis, and measuring
the distance of reconstructed trees from the optimal tree obtained when
all taxa are included in phylogenetic inference.</p>
<p>As Denton and Goolsby (2018)
 emphasize, the
Robinson–Foulds distance is unsuitable for this purpose; this function
allows the user to specify a preferred tree distance measure, defaulting
to the clustering information distance (Smith 2020)
.
Because optimal parsimony trees are not equiprobable, taxon influence is
ranked based on the maximum and minimum tree-to-tree distances between
optimal trees.</p>
    </div>
    <div class="section level2">
    <h2 id="distance-weighted-mean">Distance-weighted mean<a class="anchor" aria-label="anchor" href="#distance-weighted-mean"></a></h2>


<p>Sets of equally parsimonious trees are not statistical samples of tree space,
but are biased towards areas of uncertainty.
It is possible that a set of trees contains all possible resolutions of a
particular clade, and a single other topology in which that clade does not
exist – essentially two distinct solutions, one (<em>a</em>) which could be
summarised with a summary tree that contains a polytomy, and another (<em>b</em>)
which could be summarized by a perfectly resolved tree.
Neither of these scenarios is preferable under the principles of parsimony;
but summary statistics (e.g. mean, median) will be strongly influenced by the
many trees in group <em>a</em>, thus underplaying the existence of solution <em>b</em>.</p>
<p><code>TaxonInfluence()</code> uses an <em>ad hoc</em> method to produce summary statistics
after weighting for trees' distance from other trees.  Trees that have few
close neighbours contribute more to the weighted mean, thus reducing the
influence of many trees that differ only in small details.
This distance-weighted mean is thus less prone to bias than a simple mean
– it is no more statistically valid, but (potentially) provides a more
representative summary of comparisons between sets of trees.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Denton JS, Goolsby EW (2018).
“Measuring Inferential Importance of Taxa Using Taxon Influence Indices.”
<em>Ecology and Evolution</em>, <b>8</b>(9), 4484–4494.
<a href="https://doi.org/10.1002/ece3.3941" class="external-link">doi:10.1002/ece3.3941</a>
.<br><br> Mariadassou M, Bar-Hen A, Kishino H (2012).
“Taxon Influence Index: Assessing Taxon-Induced Incongruities in Phylogenetic Inference.”
<em>Systematic Biology</em>, <b>61</b>(2), 337–345.
<a href="https://doi.org/10.1093/sysbio/syr129" class="external-link">doi:10.1093/sysbio/syr129</a>
.<br><br> Smith MR (2020).
“Information Theoretic Generalized Robinson-Foulds Metrics for Comparing Phylogenetic Trees.”
<em>Bioinformatics</em>, <b>36</b>(20), 5007–5013.
<a href="https://doi.org/10.1093/bioinformatics/btaa614" class="external-link">doi:10.1093/bioinformatics/btaa614</a>
.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other tree scoring:
<code><a href="CharacterLength.html">CharacterLength</a>()</code>,
<code><a href="TreeLength.html">IWScore</a>()</code>,
<code><a href="LengthAdded.html">LengthAdded</a>()</code>,
<code><a href="MinimumLength.html">MinimumLength</a>()</code>,
<code><a href="MorphyTreeLength.html">MorphyTreeLength</a>()</code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p><a href="https://smithlabdurham.github.io/" class="external-link">Martin R. Smith</a>
(<a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a>)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">#' # Load data for analysis in R</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://ms609.github.io/TreeTools/" class="external-link">"TreeTools"</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"congreveLamsdellMatrices"</span>, package <span class="op">=</span> <span class="st">"TreeSearch"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Small dataset for demonstration purposes</span></span></span>
<span class="r-in"><span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="va">congreveLamsdellMatrices</span><span class="op">[[</span><span class="fl">42</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">bestTree</span> <span class="op">&lt;-</span> <span class="fu"><a href="MaximizeParsimony.html">MaximizeParsimony</a></span><span class="op">(</span><span class="va">dataset</span>, verbosity <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate tip influence</span></span></span>
<span class="r-in"><span><span class="va">influence</span> <span class="op">&lt;-</span> <span class="fu">TaxonInfluence</span><span class="op">(</span><span class="va">dataset</span>, ratchIt <span class="op">=</span> <span class="fl">0</span>, startIt <span class="op">=</span> <span class="fl">0</span>, verbos <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">BEGIN TREE SEARCH (k = Inf)</span> <span style="color: #00BBBB;">─────────────────────────────────────────────────</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → Initial score: <span style="font-weight: bold;">86 </span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Sample local optimum</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → TBR depth 2; keeping 14.4 trees; k = Inf</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> 2025-04-29 10:56:55: Score: 86</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> 2025-04-29 10:56:55: Tree search terminated with score <span style="font-weight: bold;">82</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Colour tip labels according to their influence</span></span></span>
<span class="r-in"><span><span class="va">upperBound</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">*</span> <span class="fu">TreeDist</span><span class="fu">::</span><span class="fu"><a href="https://ms609.github.io/TreeDist/reference/TreeInfo.html" class="external-link">ClusteringEntropy</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ms609.github.io/TreeTools/reference/GenerateTree.html" class="external-link">PectinateTree</a></span><span class="op">(</span><span class="fu"><a href="https://ms609.github.io/TreeTools/reference/NTip.html" class="external-link">NTip</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">nBin</span> <span class="op">&lt;-</span> <span class="fl">128</span></span></span>
<span class="r-in"><span><span class="va">bin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">influence</span><span class="op">[</span><span class="st">"max"</span>, <span class="op">]</span>,</span></span>
<span class="r-in"><span>  breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">upperBound</span>, length.out <span class="op">=</span> <span class="va">nBin</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  include.lowest <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">palette</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">hcl.colors</a></span><span class="op">(</span><span class="va">nBin</span>, <span class="st">"inferno"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">bestTree</span>, tip.color <span class="op">=</span> <span class="va">palette</span><span class="op">[</span><span class="va">bin</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">PlotTools</span><span class="fu">::</span><span class="fu"><a href="https://ms609.github.io/PlotTools/reference/SpectrumLegend.html" class="external-link">SpectrumLegend</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="st">"bottomleft"</span>,</span></span>
<span class="r-in"><span>  palette <span class="op">=</span> <span class="va">palette</span>,</span></span>
<span class="r-in"><span>  title <span class="op">=</span> <span class="st">"Tip influence / bits"</span>,</span></span>
<span class="r-in"><span>  legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">signif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">upperBound</span>, <span class="fl">0</span>, length.out <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  bty <span class="op">=</span> <span class="st">"n"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="TaxonInfluence-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://smithlabdurham.github.io/" class="external-link">Martin R. Smith</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.9000.</p>
</div>

    </footer></div>





  </body></html>

