<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Concordance factors — SiteConcordance • TreeSearch</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Concordance factors — SiteConcordance"><meta name="description" content="Concordance measures the strength of support that characters in a dataset
present for each split (=edge/branch) in a tree
(Minh et al. 2020; Smith 2026)
."><meta property="og:description" content="Concordance measures the strength of support that characters in a dataset
present for each split (=edge/branch) in a tree
(Minh et al. 2020; Smith 2026)
."><meta name="robots" content="noindex"><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-V9DV1LS35J"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-V9DV1LS35J');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">TreeSearch</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.8.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Getting started</h6></li>
    <li><a class="dropdown-item" href="../articles/getting-started.html">Getting started: Installing R and TreeSearch</a></li>
    <li><a class="dropdown-item" href="../articles/tree-search.html">Getting started: Simple tree searches</a></li>
    <li><a class="dropdown-item" href="../articles/tree-space.html">Getting started: Exploring tree space</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Advanced use</h6></li>
    <li><a class="dropdown-item" href="../articles/profile-scores.html">Profile parsimony</a></li>
    <li><a class="dropdown-item" href="../articles/profile.html">Tree search with Profile parsimony</a></li>
    <li><a class="dropdown-item" href="../articles/custom.html">Tree search with custom optimality criteria</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ms609/TreeSearch/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Concordance factors</h1>
      <small class="dont-index">Source: <a href="https://github.com/ms609/TreeSearch/blob/main/R/Concordance.R" class="external-link"><code>R/Concordance.R</code></a></small>
      <div class="d-none name"><code>SiteConcordance.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Concordance measures the strength of support that characters in a dataset
present for each split (=edge/branch) in a tree
(Minh et al. 2020; Smith 2026)
.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ClusteringConcordance</span><span class="op">(</span><span class="va">tree</span>, <span class="va">dataset</span>, return <span class="op">=</span> <span class="st">"edge"</span>, normalize <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">MutualClusteringConcordance</span><span class="op">(</span><span class="va">tree</span>, <span class="va">dataset</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">QuartetConcordance</span><span class="op">(</span><span class="va">tree</span>, dataset <span class="op">=</span> <span class="cn">NULL</span>, weight <span class="op">=</span> <span class="cn">TRUE</span>, return <span class="op">=</span> <span class="st">"edge"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">PhylogeneticConcordance</span><span class="op">(</span><span class="va">tree</span>, <span class="va">dataset</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">SharedPhylogeneticConcordance</span><span class="op">(</span><span class="va">tree</span>, <span class="va">dataset</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-tree">tree<a class="anchor" aria-label="anchor" href="#arg-tree"></a></dt>
<dd><p>A tree of class <code><a href="https://rdrr.io/pkg/ape/man/read.tree.html" class="external-link">phylo</a></code>.</p></dd>


<dt id="arg-dataset">dataset<a class="anchor" aria-label="anchor" href="#arg-dataset"></a></dt>
<dd><p>A phylogenetic data matrix of <span class="pkg">phangorn</span> class
<code>phyDat</code>, whose names correspond to the labels of any accompanying tree.
Perhaps load into R using <code><a href="https://ms609.github.io/TreeTools/reference/ReadCharacters.html" class="external-link">ReadAsPhyDat()</a></code>.
Additive (ordered) characters can be handled using
<code><a href="https://ms609.github.io/TreeTools/reference/Decompose.html" class="external-link">Decompose()</a></code>.</p></dd>


<dt id="arg-return">return<a class="anchor" aria-label="anchor" href="#arg-return"></a></dt>
<dd><p>Character specifying the summary to return. Options are:</p><ul><li><p><code>"edge"</code>: average concordance of each tree split across all characters;</p></li>
<li><p><code>"char"</code>: concordance of each character averaged over all splits, weighted
by each character's information content;</p></li>
<li><p><code>"tree"</code>: an overall tree‑level concordance score;</p></li>
<li><p><code>"all"</code>: a full array of MI components and normalized values for every
split–character pair.</p></li>
</ul><p>Matching is case‑insensitive and partial.</p></dd>


<dt id="arg-normalize">normalize<a class="anchor" aria-label="anchor" href="#arg-normalize"></a></dt>
<dd><p>Controls how the <em>expected</em> mutual information (the zero
point of the scale) is determined.</p><ul><li><p><code>FALSE</code>: no chance correction; MI is scaled only by its maximum.</p></li>
<li><p><code>TRUE</code>: subtract the analytical expected MI for random association.</p></li>
<li><p><code>&lt;integer&gt;</code>: subtract an empirical expected MI estimated from that
number of random trees.</p></li>
</ul><p>In all cases, 1 corresponds to the maximal attainable MI for the pair
(<code>hBest</code>), and 0 corresponds to the chosen expectation.</p></dd>


<dt id="arg-weight">weight<a class="anchor" aria-label="anchor" href="#arg-weight"></a></dt>
<dd><p>Logical specifying whether to weight sites according to the
number of quartets they are decisive for.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>ClusteringConcordance(return = "all")</code> returns a 3D array where each
slice corresponds to a character (site), each column to a tree split, and
each row to a different information measure. The <code>normalized</code> row gives the
normalized mutual information between each split-character pair, scaled so
that 1.0 corresponds to <code>hBest</code> (the theoretical maximum mutual information,
being the minimum of <code>hSplit</code> and <code>hChar</code>) and 0.0 corresponds to <code>miRand</code>
(the expected mutual information under random association). <code>hSplit</code> gives
the entropy (information content) of each split's bipartition; <code>hChar</code> gives
the entropy of each character's state distribution; <code>hJoint</code> gives the joint
entropy of the split-character confusion matrix; <code>mi</code> gives the raw mutual
information; and <code>n</code> records the number of informative observations.
Negative normalized values indicate observed mutual information below random
expectation. <code>NA</code> is returned when <code>hBest = 0</code> (no information potential).</p>
<p><code>ClusteringConcordance(return = "edge")</code> returns a vector where each element
corresponds to a split (an edge of the tree) and gives the normalized mutual
information between that split and the character data, averaged across all
characters.
When <code>normalize = TRUE</code> (default), values are scaled relative to random
expectation; when <code>FALSE</code>, raw mutual information normalized by <code>hBest</code> is
returned.</p>
<p><code>ClusteringConcordance(return = "char")</code> returns a vector where each element
corresponds to a character (site) and gives the entropy-weighted average
normalized mutual information between that character and all tree splits.
Characters with higher information content receive proportionally more weight
from splits that can potentially convey more information about them.</p>
<p><code>ClusteringConcordance(return = "tree")</code> returns a single value representing
the overall concordance between the tree topology and the character data.
This averages the fit of the best-matching split for each character.
This is included for completeness, though it is not clear that this is a useful
or meaningful measure.</p>
<p><code>MutualClusteringConcordance()</code> returns the mutual clustering
concordance of each character in <code>dataset</code> with <code>tree</code>.
The attribute <code>weighted.mean</code> gives the mean value, weighted by the
information content of each character.</p>
<p><code>QuartetConcordance(return = "edge")</code> returns a numeric vector giving the
concordance index at each split across all sites; names specify the number of
each corresponding split in <code>tree</code>.</p>
<p><code>QuartetConcordance(return = "char")</code> returns a numeric vector giving the
concordance index calculated at each site, averaged across all splits.</p>
<p><code>PhylogeneticConcordance()</code> returns a numeric vector giving the
phylogenetic information of each split in <code>tree</code>, named according to the
split's internal numbering.</p>
<p><code>SharedPhylogeneticConcordance()</code> returns the shared phylogenetic
concordance of each character in <code>dataset</code> with <code>tree</code>.
The attribute <code>weighted.mean</code> gives the mean value, weighted by the
information content of each character.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>ClusteringConcordance()</code> measures how well each tree split reflects the
grouping structure implied by each character
(Smith 2026)
.
Characters and splits are treated as clusterings of taxa, and their agreement
is quantified using mutual information (MI). All reported values are scaled
so that 1 corresponds to the maximum possible mutual information for each
split–character pair (<code>hBest</code>).</p>
<p>The <code>normalize</code> argument specifies how the zero point is defined.</p><ul><li><p>If <code>normalize = FALSE</code>, zero corresponds to <em>zero</em> MI, without correcting
for the positive bias that arises because MI is rarely exactly zero in
finite samples.</p></li>
<li><p>If <code>normalize = TRUE</code>, the expected MI is computed using an analytical
approximation based on the distribution of character tokens. This is fast
and generally accurate for large trees (~200+ taxa), but does not account
for correlation between splits.</p></li>
<li><p>If <code>normalize</code> is a positive integer <code>n</code>, the expected MI is estimated
empirically by fitting each character to <code>n</code> uniformly random trees and
averaging the resulting MI values. This Monte Carlo approach provides a
more accurate baseline for small trees, for which the analytical
approximation is biased. Monte Carlo standard errors are returned.</p></li>
</ul><p><code>MutualClusteringConcordance()</code> provides a character‑wise summary that
emphasises each character’s best‑matching split(s). It treats each character
as a simple tree and computes the mutual clustering information between this
character‑tree and the supplied phylogeny. High values identify characters
whose signal is well represented anywhere in the tree, even if concentrated
on a single edge.</p>
<p><code>QuartetConcordance()</code> is the proportion of quartets (sets of four leaves)
that are decisive for a split which are also concordant with it
(the site concordance factor (Minh et al. 2020)
).
For example, a quartet with the characters <code>0 0 0 1</code> is not decisive, as
all relationships between those leaves are equally parsimonious.
But a quartet with characters <code>0 0 1 1</code> is decisive, and is concordant
with any tree that groups the first two leaves together to the exclusion
of the second.</p>
<p>By default, the reported value weights each site by the number of quartets
it is decisive for.  This value can be interpreted as the proportion of
all decisive quartets that are concordant with a split.
If <code>weight = FALSE</code>, the reported value is the mean of the concordance
value for each site.
Consider a split associated with two sites:
one that is concordant with 25% of 96 decisive quartets, and
a second that is concordant with 75% of 4 decisive quartets.
If <code>weight = TRUE</code>, the split concordance will be 24 + 3 / 96 + 4 = 27%.
If <code>weight = FALSE</code>, the split concordance will be mean(75%, 25%) = 50%.</p>
<p><code>QuartetConcordance()</code> is computed exactly, using all quartets, where as
other implementations (e.g. IQ-TREE) follow
Minh2020)
 in using a random subsample
of quartets for a faster, if potentially less accurate, computation.
Ambiguous and inapplicable tokens are treated as containing no grouping
information (i.e. <code>(02)</code> or <code>-</code> are each treated as <code>?</code>).</p>
<p><code>PhylogeneticConcordance()</code> treats each character in <code>dataset</code> as a
phylogenetic hypothesis and measures the extent to which it supports the
splits of <code>tree</code>. Each character is first interpreted as a tree (or set of
trees) in which taxa sharing the same token form a clade. Only splits for
which the character contains at least four relevant taxa can contribute
information.</p>
<p>For each split, the function identifies which characters could potentially
support that split (i.e. those for which the induced subtrees contain
informative structure), and among these, which characters are actually
compatible with the split. The concordance value for each split is the
proportion of informative characters that support it.
A value of 1 indicates that all characters informative for that subset of
taxa support the split; a value of 0 indicates that none do. Characters that
contain only ambiguous or uninformative states for the relevant taxa do not
affect the result.</p>
<p><code>SharedPhylogeneticConcordance()</code> treats each character as a simple tree.
Each token in the character corresponds to a node whose pendant edges are the
taxa with that token.
The Shared Phylogenetic Concordance for each character in <code>dataset</code> is then
the Shared Phylogenetic Information (Smith 2020)
 of
this tree and <code>tree</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Minh BQ, Hahn MW, Lanfear R (2020).
“New methods to calculate concordance factors for phylogenomic datasets.”
<em>Molecular Biology and Evolution</em>, <b>37</b>(9), 2727–2733.
<a href="https://doi.org/10.1093/molbev/msaa106" class="external-link">doi:10.1093/molbev/msaa106</a>
.<br><br> Smith MR (2020).
“Information Theoretic Generalized Robinson-Foulds Metrics for Comparing Phylogenetic Trees.”
<em>Bioinformatics</em>, <b>36</b>(20), 5007–5013.
<a href="https://doi.org/10.1093/bioinformatics/btaa614" class="external-link">doi:10.1093/bioinformatics/btaa614</a>
.<br><br> Smith MR (2026).
“Which characters support which clades? Exploring the distribution of phylogenetic signal using concordant information.”
<em>Forthcoming</em>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index">
<ul><li><p><code><a href="ConcordanceTable.html">ConcordanceTable()</a></code>: Visualize concordance.</p></li>
<li><p><code><a href="Consistency.html">Consistency()</a></code>: Measure consistency of characters with dataset.</p></li>
</ul><p>Other split support functions:
<code><a href="ConcordanceTable.html">ConcordanceTable()</a></code>,
<code><a href="JackLabels.html">JackLabels()</a></code>,
<code><a href="Jackknife.html">Jackknife()</a></code>,
<code><a href="MaximizeParsimony.html">MaximizeParsimony()</a></code>,
<code><a href="MostContradictedFreq.html">MostContradictedFreq()</a></code>,
<code><a href="PresCont.html">PresCont()</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p><a href="https://smithlabdurham.github.io/" class="external-link">Martin R. Smith</a>
(<a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a>)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>

    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://smithlabdurham.github.io/" class="external-link">Martin R. Smith</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

