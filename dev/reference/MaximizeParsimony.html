<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Find most parsimonious trees — MaximizeParsimony • TreeSearch</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Find most parsimonious trees — MaximizeParsimony"><meta name="description" content="Search for most parsimonious trees using the parsimony ratchet and
TBR rearrangements, treating inapplicable data as such using the
algorithm of Brazeau et al. (2019)
.
Tree search will be conducted from a specified or automatically-generated
starting tree in order to find a tree with an optimal parsimony score,
under implied or equal weights, treating inapplicable characters as such
in order to avoid the artefacts of the standard Fitch algorithm
(see Maddison 1993; Brazeau et al. 2019)
.
Tree length is calculated using the MorphyLib C library
(Brazeau et al. 2017)
."><meta property="og:description" content="Search for most parsimonious trees using the parsimony ratchet and
TBR rearrangements, treating inapplicable data as such using the
algorithm of Brazeau et al. (2019)
.
Tree search will be conducted from a specified or automatically-generated
starting tree in order to find a tree with an optimal parsimony score,
under implied or equal weights, treating inapplicable characters as such
in order to avoid the artefacts of the standard Fitch algorithm
(see Maddison 1993; Brazeau et al. 2019)
.
Tree length is calculated using the MorphyLib C library
(Brazeau et al. 2017)
."><meta name="robots" content="noindex"><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-V9DV1LS35J"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-V9DV1LS35J');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">TreeSearch</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.6.1.9001</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Getting started</h6></li>
    <li><a class="dropdown-item" href="../articles/getting-started.html">Getting started: Installing R and TreeSearch</a></li>
    <li><a class="dropdown-item" href="../articles/tree-search.html">Getting started: Simple tree searches</a></li>
    <li><a class="dropdown-item" href="../articles/tree-space.html">Getting started: Exploring tree space</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Advanced use</h6></li>
    <li><a class="dropdown-item" href="../articles/profile-scores.html">Profile parsimony</a></li>
    <li><a class="dropdown-item" href="../articles/profile.html">Tree search with Profile parsimony</a></li>
    <li><a class="dropdown-item" href="../articles/custom.html">Tree search with custom optimality criteria</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ms609/TreeSearch/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Find most parsimonious trees</h1>
      <small class="dont-index">Source: <a href="https://github.com/ms609/TreeSearch/blob/master/R/MaximizeParsimony.R" class="external-link"><code>R/MaximizeParsimony.R</code></a></small>
      <div class="d-none name"><code>MaximizeParsimony.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Search for most parsimonious trees using the parsimony ratchet and
<acronym>TBR</acronym> rearrangements, treating inapplicable data as such using the
algorithm of Brazeau et al. (2019)
.</p>
<p>Tree search will be conducted from a specified or automatically-generated
starting tree in order to find a tree with an optimal parsimony score,
under implied or equal weights, treating inapplicable characters as such
in order to avoid the artefacts of the standard Fitch algorithm
(see Maddison 1993; Brazeau et al. 2019)
.
Tree length is calculated using the MorphyLib C library
(Brazeau et al. 2017)
.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">MaximizeParsimony</span><span class="op">(</span></span>
<span>  <span class="va">dataset</span>,</span>
<span>  <span class="va">tree</span>,</span>
<span>  ratchIter <span class="op">=</span> <span class="fl">7L</span>,</span>
<span>  tbrIter <span class="op">=</span> <span class="fl">2L</span>,</span>
<span>  startIter <span class="op">=</span> <span class="fl">2L</span>,</span>
<span>  finalIter <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  maxHits <span class="op">=</span> <span class="fu"><a href="https://ms609.github.io/TreeTools/reference/NTip.html" class="external-link">NTip</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">)</span> <span class="op">*</span> <span class="fl">1.8</span>,</span>
<span>  maxTime <span class="op">=</span> <span class="fl">60</span>,</span>
<span>  quickHits <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">3</span>,</span>
<span>  concavity <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  ratchEW <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  tolerance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">.Machine</span><span class="op">[[</span><span class="st">"double.eps"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  <span class="va">constraint</span>,</span>
<span>  verbosity <span class="op">=</span> <span class="fl">3L</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">Resample</span><span class="op">(</span></span>
<span>  <span class="va">dataset</span>,</span>
<span>  <span class="va">tree</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"jack"</span>,</span>
<span>  proportion <span class="op">=</span> <span class="fl">2</span><span class="op">/</span><span class="fl">3</span>,</span>
<span>  ratchIter <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  tbrIter <span class="op">=</span> <span class="fl">8L</span>,</span>
<span>  finalIter <span class="op">=</span> <span class="fl">3L</span>,</span>
<span>  maxHits <span class="op">=</span> <span class="fl">12L</span>,</span>
<span>  concavity <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  tolerance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">.Machine</span><span class="op">[[</span><span class="st">"double.eps"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  <span class="va">constraint</span>,</span>
<span>  verbosity <span class="op">=</span> <span class="fl">2L</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">EasyTrees</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">EasyTreesy</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-dataset">dataset<a class="anchor" aria-label="anchor" href="#arg-dataset"></a></dt>
<dd><p>A phylogenetic data matrix of <span class="pkg">phangorn</span> class
<code>phyDat</code>, whose names correspond to the labels of any accompanying tree.
Perhaps load into R using <code><a href="https://ms609.github.io/TreeTools/reference/ReadCharacters.html" class="external-link">ReadAsPhyDat</a></code>.
Additive (ordered) characters can be handled using
<code><a href="https://ms609.github.io/TreeTools/reference/Decompose.html" class="external-link">Decompose</a></code>.</p></dd>


<dt id="arg-tree">tree<a class="anchor" aria-label="anchor" href="#arg-tree"></a></dt>
<dd><p>(optional) A bifurcating tree of class <code><a href="https://rdrr.io/pkg/ape/man/read.tree.html" class="external-link">phylo</a></code>,
containing only the tips listed in <code>dataset</code>, from which the search
should begin.
If unspecified, an <a href="AdditionTree.html">addition tree</a> will be generated from
<code>dataset</code>, respecting any supplied <code>constraint</code>.
Edge lengths are not supported and will be deleted.</p></dd>


<dt id="arg-ratchiter">ratchIter<a class="anchor" aria-label="anchor" href="#arg-ratchiter"></a></dt>
<dd><p>Numeric specifying number of iterations of the
parsimony ratchet (Nixon 1999)
 to conduct.</p></dd>


<dt id="arg-tbriter">tbrIter<a class="anchor" aria-label="anchor" href="#arg-tbriter"></a></dt>
<dd><p>Numeric specifying the maximum number of <acronym>TBR</acronym>
break points on a given tree to evaluate before terminating the search.
One "iteration" comprises selecting a branch to break, and evaluating
each possible reconnection point in turn until a new tree improves the
score. If a better score is found, then the counter is reset to zero,
and tree search continues from the improved tree.</p></dd>


<dt id="arg-startiter">startIter<a class="anchor" aria-label="anchor" href="#arg-startiter"></a></dt>
<dd><p>Numeric: an initial round of tree search with
<code>startIter</code> × <code>tbrIter</code> <acronym>TBR</acronym> break points is conducted in
order to locate a local optimum before beginning ratchet searches.</p></dd>


<dt id="arg-finaliter">finalIter<a class="anchor" aria-label="anchor" href="#arg-finaliter"></a></dt>
<dd><p>Numeric: a final round of tree search will evaluate
<code>finalIter</code> × <code>tbrIter</code> <acronym>TBR</acronym> break points, in order to
sample the final optimal neighbourhood more intensely.</p></dd>


<dt id="arg-maxhits">maxHits<a class="anchor" aria-label="anchor" href="#arg-maxhits"></a></dt>
<dd><p>Numeric specifying the maximum times that an optimal
parsimony score may be hit before concluding a ratchet iteration or final
search concluded.</p></dd>


<dt id="arg-maxtime">maxTime<a class="anchor" aria-label="anchor" href="#arg-maxtime"></a></dt>
<dd><p>Numeric: after <code>maxTime</code> minutes, stop tree search at the
next opportunity.</p></dd>


<dt id="arg-quickhits">quickHits<a class="anchor" aria-label="anchor" href="#arg-quickhits"></a></dt>
<dd><p>Numeric: iterations on subsampled datasets
will retain <code>quickHits</code> × <code>maxHits</code> trees with the best score.</p></dd>


<dt id="arg-concavity">concavity<a class="anchor" aria-label="anchor" href="#arg-concavity"></a></dt>
<dd><p>Determines the degree to which extra steps beyond the first
are penalized.  Specify a numeric value to use implied weighting
(Goloboff 1993)
; <code>concavity</code> specifies <em>k</em> in
<em>k</em> / <em>e</em> + <em>k</em>. A value of 10 is recommended;
TNT sets a default of 3, but this is too low in some circumstances
(Goloboff et al. 2018; Smith 2019)
.
Better still explore the sensitivity of results under a range of
concavity values, e.g. <code>k = 2 ^ (1:7)</code>.
Specify <code>Inf</code> to weight each additional step equally,
(which underperforms step weighting approaches
(Goloboff et al. 2008; Goloboff et al. 2018; Goloboff and Arias 2019; Smith 2019)
).
Specify <code>"profile"</code> to employ an approximation of profile parsimony
(Faith and Trueman 2001)
.</p></dd>


<dt id="arg-ratchew">ratchEW<a class="anchor" aria-label="anchor" href="#arg-ratchew"></a></dt>
<dd><p>Logical specifying whether to use equal weighting during
ratchet iterations, improving search speed whilst still facilitating
escape from local optima.</p></dd>


<dt id="arg-tolerance">tolerance<a class="anchor" aria-label="anchor" href="#arg-tolerance"></a></dt>
<dd><p>Numeric specifying degree of suboptimality to tolerate
before rejecting a tree.  The default, <code>sqrt(.Machine$double.eps)</code>, retains
trees that may be equally parsimonious but for rounding errors.
Setting to larger values will include trees suboptimal by up to <code>tolerance</code>
in search results, which may improve the accuracy of the consensus tree
(at the expense of resolution) (Smith 2019)
.</p></dd>


<dt id="arg-constraint">constraint<a class="anchor" aria-label="anchor" href="#arg-constraint"></a></dt>
<dd><p>Either an object of class <code>phyDat</code>, in which case
returned trees will be perfectly compatible with each character in
<code>constraint</code>; or a tree of class <code>phylo</code>, all of whose nodes will occur
in any output tree.
See <code><a href="https://ms609.github.io/TreeTools/reference/ImposeConstraint.html" class="external-link">ImposeConstraint()</a></code> and
<a href="https://ms609.github.io/TreeSearch/articles/tree-search.html">vignette</a>
for further examples.</p></dd>


<dt id="arg-verbosity">verbosity<a class="anchor" aria-label="anchor" href="#arg-verbosity"></a></dt>
<dd><p>Integer specifying level of messaging; higher values give
more detailed commentary on search progress. Set to <code>0</code> to run silently.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>Unambiguous abbreviation of <code>jackknife</code> or <code>bootstrap</code>
specifying how to resample characters.  Note that jackknife is considered
to give more meaningful results.</p></dd>


<dt id="arg-proportion">proportion<a class="anchor" aria-label="anchor" href="#arg-proportion"></a></dt>
<dd><p>Numeric between 0 and 1 specifying what proportion of
characters to retain under jackknife resampling.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional parameters to <code>MaximizeParsimony()</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>MaximizeParsimony()</code> returns a list of trees with class
<code>multiPhylo</code>. This lists all trees found during each search step that
are within <code>tolerance</code> of the optimal score, listed in the sequence that
they were first visited, and named according to the step in which they were
first found; it may contain more than <code>maxHits</code> elements.
Note that the default search parameters may need to be increased in order for
these trees to be the globally optimal trees; examine the messages printed
during tree search to evaluate whether the optimal score has stabilized.</p>
<p>The return value has the attribute <code>firstHit</code>, a named integer vector listing
the number of optimal trees visited for the first time in each stage of
the tree search. Stages are named:</p><ul><li><p><code>seed</code>: starting trees;</p></li>
<li><p><code>start</code>: Initial TBR search;</p></li>
<li><p><code>ratchN</code>: Ratchet iteration <code>N</code>;</p></li>
<li><p><code>final</code>: Final TBR search.
The first tree hit for the first time in ratchet iteration three is named
<code>ratch3_1</code>.</p></li>
</ul><p><code>Resample()</code> returns a <code>multiPhylo</code> object containing a list of
trees obtained by tree search using a resampled version of <code>dataset</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Tree search commences with <code>ratchIter</code> iterations of the parsimony ratchet
(Nixon 1999)
, which bootstraps the input dataset
in order to escape local optima.
A final round of tree bisection and reconnection (<acronym>TBR</acronym>)
is conducted to broaden the sampling of trees.</p>
<p>This function can be called using the R command line / terminal, or through
the "shiny" graphical user interface app (type <code>EasyTrees()</code> to launch).</p>
<p>The optimal strategy for tree search depends in part on how close to optimal
the starting tree is, the size of the search space (which increases
super-exponentially with the number of leaves), and the complexity of the
search space (e.g. the existence of multiple local optima).</p>
<p>One possible approach is to employ four phases:</p><ol><li><p>Rapid search for local optimum: tree score is typically easy to improve
early in a search, because the initial tree is often far from optimal.
When many moves are likely to be accepted, running several rounds of search
with a low value of <code>maxHits</code> and a high value of <code>tbrIter</code> allows many
trees to be evaluated quickly, hopefully moving quickly to a more promising
region of tree space.</p></li>
<li><p>Identification of local optimum:
Once close to a local optimum, a more extensive search
with a higher value of <code>maxHits</code> allows a region to be explored in more
detail.  Setting a high value of <code>tbrIter</code> will search a local
neighbourhood more completely</p></li>
<li><p>Search for nearby peaks:
Ratchet iterations allow escape from local optima.
Setting <code>ratchIter</code> to a high value searches the wider neighbourhood more
extensively for other nearby peaks; <code>ratchEW = TRUE</code> accelerates these
exploratory searches.  Ratchet iterations can be ineffective when <code>maxHits</code>
is too low for the search to escape its initial location.</p></li>
<li><p>Extensive search of final optimum.  As with step 2, it may be valuable to
fully explore the optimum that is found after ratchet searches to be sure
that the locally optimal score has been obtained.  Setting a high value of
<code>finalIter</code> performs a thorough search that can give confidence that further
searches would not find better (local) trees.</p></li>
</ol><p>A search is unlikely to have found a global optimum if:</p><ul><li><p>Tree score continues to improve on the final iteration.  If a local optimum
has not yet been reached, it is unlikely that a global optimum has
been reached.
Try increasing <code>maxHits</code>.</p></li>
<li><p>Successive ratchet iterations continue to improve tree scores.
If a recent ratchet iteration improved the score, rather than finding
a different region of tree space with the same optimal score, it is likely
that still better global optima remain to be found.  Try increasing
<code>ratchIter</code> (more iterations give more chance for improvement) and
<code>maxHits</code> (to get closer to the local optimum after each ratchet iteration).</p></li>
<li><p>Optimal areas of tree space are only visited by a single ratchet iteration.
(See vignette: <a href="https://ms609.github.io/TreeSearch/articles/tree-space.html">Exploring tree space</a>.)
If some areas of tree space are only found by one ratchet iteration, there
may well be other, better areas that have not yet been visited.
Try increasing <code>ratchIter</code>.</p></li>
</ul><p>When continuing a tree search, it is usually best to start from an optimal
tree found during the previous iteration – there is no need to start from
scratch.</p>
<p>A more time consuming way of checking that a global optimum has been reached
is to repeat a search with the same parameters multiple times, starting
from a different, entirely random tree each time. If all searches obtain the
same optimal tree score despite their different starting points,
this score is likely to correspond to the global optimum.</p>
<p>For detailed documentation of the "TreeSearch" package, including full
instructions for loading phylogenetic data into R and initiating and
configuring tree search, see the
<a href="https://ms609.github.io/TreeSearch/">package documentation</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="resampling">Resampling<a class="anchor" aria-label="anchor" href="#resampling"></a></h2>


<p>Note that bootstrap support is a measure of the amount of data supporting
a split, rather than the amount of confidence that should be afforded the
grouping.
"Bootstrap support of 100% is not enough, the tree must also be correct"
(Phillips et al. 2004)
.
See discussion in Egan (2006)
;
Wagele et al. (2009)
;
(Simmons and Freudenstein 2011)
;
Kumar et al. (2012)
.</p>
<p>For a discussion of suitable search parameters in resampling estimates, see
Muller (2005)
.
The user should decide whether to start each resampling
from the optimal tree (which may be quicker, but result in overestimated
support values as searches get stuck in local optima close to the
optimal tree) or a random tree (which may take longer as more rearrangements
are necessary to find an optimal tree on each iteration).</p>
<p>For other ways to estimate clade concordance, see <code><a href="SiteConcordance.html">SiteConcordance()</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Brazeau MD, Guillerme T, Smith MR (2019).
“An algorithm for morphological phylogenetic analysis with inapplicable data.”
<em>Systematic Biology</em>, <b>68</b>(4), 619–631.
<a href="https://doi.org/10.1093/sysbio/syy083" class="external-link">doi:10.1093/sysbio/syy083</a>
.<br><br> Brazeau MD, Smith MR, Guillerme T (2017).
“MorphyLib: a library for phylogenetic analysis of categorical trait data with inapplicability.”
<a href="https://doi.org/10.5281/zenodo.815372" class="external-link">doi:10.5281/zenodo.815372</a>
.<br><br> Egan MG (2006).
“Support versus corroboration.”
<em>Journal of Biomedical Informatics</em>, <b>39</b>(1), 72–85.
<a href="https://doi.org/10.1016/j.jbi.2005.11.007" class="external-link">doi:10.1016/j.jbi.2005.11.007</a>
.<br><br> Faith DP, Trueman JWH (2001).
“Towards an inclusive philosophy for phylogenetic inference.”
<em>Systematic Biology</em>, <b>50</b>(3), 331–350.
<a href="https://doi.org/10.1080/10635150118627" class="external-link">doi:10.1080/10635150118627</a>
.<br><br> Goloboff PA (1993).
“Estimating character weights during tree search.”
<em>Cladistics</em>, <b>9</b>(1), 83–91.
<a href="https://doi.org/10.1111/j.1096-0031.1993.tb00209.x" class="external-link">doi:10.1111/j.1096-0031.1993.tb00209.x</a>
.<br><br> Goloboff PA, Arias JS (2019).
“Likelihood approximations of implied weights parsimony can be selected over the Mk model by the Akaike information criterion.”
<em>Cladistics</em>, <b>35</b>(6), 695–716.
<a href="https://doi.org/10.1111/cla.12380" class="external-link">doi:10.1111/cla.12380</a>
.<br><br> Goloboff PA, Carpenter JM, Arias JS, Esquivel DRM (2008).
“Weighting against homoplasy improves phylogenetic analysis of morphological data sets.”
<em>Cladistics</em>, <b>24</b>(5), 758–773.
<a href="https://doi.org/10.1111/j.1096-0031.2008.00209.x" class="external-link">doi:10.1111/j.1096-0031.2008.00209.x</a>
.<br><br> Goloboff PA, Torres A, Arias JS (2018).
“Weighted parsimony outperforms other methods of phylogenetic inference under models appropriate for morphology.”
<em>Cladistics</em>, <b>34</b>(4), 407–437.
<a href="https://doi.org/10.1111/cla.12205" class="external-link">doi:10.1111/cla.12205</a>
.<br><br> Kumar S, Filipski AJ, Battistuzzi FU, Kosakovsky Pond SL, Tamura K (2012).
“Statistics and truth in phylogenomics.”
<em>Molecular Biology and Evolution</em>, <b>29</b>(2), 457–472.
<a href="https://doi.org/10.1093/molbev/msr202" class="external-link">doi:10.1093/molbev/msr202</a>
.<br><br> Maddison WP (1993).
“Missing data versus missing characters in phylogenetic analysis.”
<em>Systematic Biology</em>, <b>42</b>(4), 576–581.
<a href="https://doi.org/10.1093/sysbio/42.4.576" class="external-link">doi:10.1093/sysbio/42.4.576</a>
.<br><br> Muller KF (2005).
“The efficiency of different search strategies in estimating parsimony jackknife, bootstrap, and Bremer support.”
<em>BMC Evolutionary Biology</em>, <b>5</b>(1), 58.
<a href="https://doi.org/10.1186/1471-2148-5-58" class="external-link">doi:10.1186/1471-2148-5-58</a>
.<br><br> Nixon KC (1999).
“The Parsimony Ratchet, a new method for rapid parsimony analysis.”
<em>Cladistics</em>, <b>15</b>(4), 407–414.
ISSN 0748-3007, <a href="https://doi.org/10.1111/j.1096-0031.1999.tb00277.x" class="external-link">doi:10.1111/j.1096-0031.1999.tb00277.x</a>
.<br><br> Phillips MJ, Delsuc F, Penny D (2004).
“Genome-scale phylogeny and the detection of systematic biases.”
<em>Molecular biology and evolution</em>, <b>21</b>(7), 1455–8.
<a href="https://doi.org/10.1093/molbev/msh137" class="external-link">doi:10.1093/molbev/msh137</a>
.<br><br> Simmons MP, Freudenstein JV (2011).
“Spurious 99% bootstrap and jackknife support for unsupported clades.”
<em>Molecular Phylogenetics and Evolution</em>, <b>61</b>(1), 177–191.
<a href="https://doi.org/10.1016/j.ympev.2011.06.003" class="external-link">doi:10.1016/j.ympev.2011.06.003</a>
.<br><br> Smith MR (2019).
“Bayesian and parsimony approaches reconstruct informative trees from simulated morphological datasets.”
<em>Biology Letters</em>, <b>15</b>(2), 20180632.
<a href="https://doi.org/10.1098/rsbl.2018.0632" class="external-link">doi:10.1098/rsbl.2018.0632</a>
.<br><br> Wagele JW, Letsch H, Klussmann-Kolb A, Mayer C, Misof B, Wagele H (2009).
“Phylogenetic support values are not necessarily informative: the case of the Serialia hypothesis (a mollusk phylogeny).”
<em>Frontiers in Zoology</em>, <b>6</b>(1), 12–29.
<a href="https://doi.org/10.1186/1742-9994-6-12" class="external-link">doi:10.1186/1742-9994-6-12</a>
.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Tree search <em>via</em> graphical user interface: <code>EasyTrees()</code></p>
<p>Other split support functions:
<code><a href="JackLabels.html">JackLabels</a>()</code>,
<code><a href="Jackknife.html">Jackknife</a>()</code>,
<code><a href="SiteConcordance.html">SiteConcordance</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p><a href="https://smithlabdurham.github.io/" class="external-link">Martin R. Smith</a>
(<a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a>)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## Only run examples in interactive R sessions</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="co"># launch "shiny" point-and-click interface</span></span></span>
<span class="r-in"><span>  <span class="fu">EasyTrees</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co"># Here too, use the "continue search" function to ensure that tree score</span></span></span>
<span class="r-in"><span>  <span class="co"># has stabilized and a global optimum has been found</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Load data for analysis in R</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://ms609.github.io/TreeTools/" class="external-link">"TreeTools"</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"congreveLamsdellMatrices"</span>, package <span class="op">=</span> <span class="st">"TreeSearch"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="va">congreveLamsdellMatrices</span><span class="op">[[</span><span class="fl">42</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># A very quick run for demonstration purposes</span></span></span>
<span class="r-in"><span><span class="va">trees</span> <span class="op">&lt;-</span> <span class="fu">MaximizeParsimony</span><span class="op">(</span><span class="va">dataset</span>, ratchIter <span class="op">=</span> <span class="fl">0</span>, startIter <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>                           tbrIter <span class="op">=</span> <span class="fl">1</span>, maxHits <span class="op">=</span> <span class="fl">4</span>, maxTime <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">100</span>,</span></span>
<span class="r-in"><span>                           concavity <span class="op">=</span> <span class="fl">10</span>, verbosity <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">BEGIN TREE SEARCH (k = 10)</span> <span style="color: #00BBBB;">──────────────────────────────────────────────────</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → Initial score: <span style="font-weight: bold;">12.2689 </span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Sample local optimum</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → TBR depth 1; keeping 4 trees; k = 10</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> 2025-07-10 11:55:45: Score: 12.2689</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> 2025-07-10 11:55:46: Tree search terminated with score <span style="font-weight: bold;">12.0294</span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">trees</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "final_1"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># In actual use, be sure to check that the score has converged on a global</span></span></span>
<span class="r-in"><span><span class="co"># optimum, conducting additional iterations and runs as necessary.</span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co"># Jackknife resampling</span></span></span>
<span class="r-in"><span><span class="va">nReplicates</span> <span class="op">&lt;-</span> <span class="fl">10</span></span></span>
<span class="r-in"><span><span class="va">jackTrees</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="va">nReplicates</span>,</span></span>
<span class="r-in"><span>  <span class="co">#c() ensures that each replicate returns a list of trees</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">Resample</span><span class="op">(</span><span class="va">dataset</span>, <span class="va">trees</span>, ratchIter <span class="op">=</span> <span class="fl">0</span>, tbrIter <span class="op">=</span> <span class="fl">2</span>, startIter <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>             maxHits <span class="op">=</span> <span class="fl">5</span>, maxTime <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>             concavity <span class="op">=</span> <span class="fl">10</span>, verbosity <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># In a serious analysis, more replicates would be conducted, and each</span></span></span>
<span class="r-in"><span><span class="co"># search would undergo more iterations.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Now we must decide what to do with the multiple optimal trees from</span></span></span>
<span class="r-in"><span><span class="co"># each replicate.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Treat each tree equally</span></span></span>
<span class="r-in"><span><span class="fu"><a href="JackLabels.html">JackLabels</a></span><span class="op">(</span><span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/consensus.html" class="external-link">consensus</a></span><span class="op">(</span><span class="va">trees</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">jackTrees</span>, recursive <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Take the strict consensus of all trees for each replicate</span></span></span>
<span class="r-in"><span><span class="fu"><a href="JackLabels.html">JackLabels</a></span><span class="op">(</span><span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/consensus.html" class="external-link">consensus</a></span><span class="op">(</span><span class="va">trees</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">jackTrees</span>, <span class="fu">ape</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/ape/man/consensus.html" class="external-link">consensus</a></span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Take a single tree from each replicate (the first; order's irrelevant)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="JackLabels.html">JackLabels</a></span><span class="op">(</span><span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/consensus.html" class="external-link">consensus</a></span><span class="op">(</span><span class="va">trees</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">jackTrees</span>, <span class="va">`[[`</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Tree search with a constraint</span></span></span>
<span class="r-in"><span><span class="va">constraint</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ms609.github.io/TreeTools/reference/MatrixToPhyDat.html" class="external-link">MatrixToPhyDat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">1</span>, b <span class="op">=</span> <span class="fl">1</span>, c <span class="op">=</span> <span class="fl">0</span>, d <span class="op">=</span> <span class="fl">0</span>, e <span class="op">=</span> <span class="fl">0</span>, f <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">characters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ms609.github.io/TreeTools/reference/MatrixToPhyDat.html" class="external-link">MatrixToPhyDat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>,</span></span>
<span class="r-in"><span>    <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>  dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span>, <span class="cn">NULL</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">MaximizeParsimony</span><span class="op">(</span><span class="va">characters</span>, constraint <span class="op">=</span> <span class="va">constraint</span>, verbosity <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Initialized 1 distinct constraints.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 phylogenetic tree</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://smithlabdurham.github.io/" class="external-link">Martin R. Smith</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.9000.</p>
</div>

    </footer></div>





  </body></html>

