% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/FitchBuilder.R
\name{AssignLeavesToRegions}
\alias{AssignLeavesToRegions}
\title{Count the number of labelled rooted binary trees with leaves in specified regions}
\usage{
AssignLeavesToRegions(regions, leaves)
}
\arguments{
\item{regions}{A vector of integers, where \code{regions[[i]]} is the number of chosen edges
in region \code{i} that must receive at least one leaf.}

\item{leaves}{A vector of integers, where \code{leaves[[i]]} is the total number of labelled
leaves to be added to region \code{i}.}
}
\value{
\code{AssignLeavesToRegions()} returns a numeric scalar giving the total number
of labelled rooted binary trees consistent with the allocation of leaves to regions.
}
\description{
\code{AssignLeavesToRegions()} computes the total number of \strong{labelled rooted binary trees}
in which a specified number of leaves are assigned to distinct regions (edges) of a
starting tree. Each region receives at least one leaf, and leaves are considered
distinct (labelled).
}
\details{
For a single region with \code{e} chosen edges and \code{n} labelled leaves, the number of
trees is computed as:

\deqn{
\text{LeafAssignment}(e, n) = \sum_{k_1 + \dots + k_e = n, k_i \ge 1}
\binom{n}{k_1, \dots, k_e} \prod_{i=1}^e NRooted(k_i),
}

where

\eqn{NRooted(k) = (2k - 3)!!}
is the number of \strong{labelled rooted binary trees} with \code{k} leaves, and
\eqn{\binom{n}{k_1, \dots, k_e}} is the multinomial coefficient giving the number
of ways to assign \code{n} distinct leaves to the \code{e} edges according to the
composition \verb{(k_1, ..., k_e)}.

The total number of trees across multiple regions is obtained by taking the product
over each region:

\deqn{
\text{TotalTrees} = \prod_{i} \text{LeafAssignment}(regions[[i]], leaves[[i]])
}
}
\examples{
# One region with 1 chosen edge, 3 leaves
.AssignLeavesToRegions(list(1), list(3))

# Two regions: 1 edge with 2 leaves, 2 edges with 4 leaves
.AssignLeavesToRegions(list(1, 2), list(2, 4))

}
\seealso{
\code{\link[TreeTools:NRooted]{TreeTools::NRooted()}} for the double factorial formula counting labelled rooted trees.
}
