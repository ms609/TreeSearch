% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/IWScore.R, R/tree_length.R
\name{IWScore}
\alias{IWScore}
\alias{TreeLength}
\alias{TreeLength.phylo}
\alias{TreeLength.numeric}
\alias{TreeLength.list}
\alias{TreeLength.multiPhylo}
\alias{Fitch}
\title{Calculate parsimony score with inapplicable data}
\usage{
IWScore(tree, dataset, concavity = 10L, ...)

TreeLength(tree, dataset, concavity = Inf)

\method{TreeLength}{phylo}(tree, dataset, concavity = Inf)

\method{TreeLength}{numeric}(tree, dataset, concavity = Inf)

\method{TreeLength}{list}(tree, dataset, concavity = Inf)

\method{TreeLength}{multiPhylo}(tree, dataset, concavity = Inf)

Fitch(tree, dataset)
}
\arguments{
\item{tree}{A tree of class \code{phylo}, a list thereof (optionally of class
\code{multiPhylo}, or an integer -- in which case \code{tree} random trees will be
uniformly sampled.}

\item{dataset}{A phylogenetic data matrix of class \code{\link[phangorn]{phyDat}},
whose names correspond to the labels of any accompanying tree.}

\item{concavity}{A numeric value to use as the concavity constant (\code{k})
in implied weighting. Defaults to 10; TNT sets a default of 3, but this
is too low in some circumstances (Smith, 2019). If \code{Inf}, applies equal
weights; if \code{'profile'}, then profile parsimony is used.}

\item{\dots}{unused; allows additional parameters specified within \dots to be
received by the function without throwing an error.}
}
\value{
\code{TreeLength()} returns the elements from a list containing:
\itemize{
\item     The total parsimony score
\item     The parsimony score associated with each character
\item     A matrix comprising character reconstructions for each node
after the final pass
}

The elements to return are specified by the parameter \code{detail}.
If a single element is requested (default) then just that element will be returned
If multiple elements are requested then these will be returned in a list.

#TODO if concavity, then The 'fit', \code{h / h + k},
where \code{h} is the amount of homoplasy ('extra steps')
and \code{k} is a constant (the 'concavity constant')
}
\description{
Uses code modified from the Morphy library to calculate a
parsimony score in datasets that contain inapplicable data.

If \code{concavity} is non-infinite, using implied weights
(Goloboff 1997).
}
\examples{
data("inapplicable.datasets")
tree <- TreeTools::BalancedTree(inapplicable.phyData[[1]])
TreeLength(tree, inapplicable.phyData[[1]])
TreeLength(tree, inapplicable.phyData[[1]], 10)
}
\references{
\itemize{
\item \insertRef{Goloboff1997}{TreeSearch}
\item \insertRef{Smith2019}{TreeSearch}
}
}
\seealso{
\itemize{
\item \code{\link[=TreeSearch]{TreeSearch()}}
}

Other tree scoring: 
\code{\link{CharacterLength}()},
\code{\link{MorphyTreeLength}()}
}
\author{
Martin R. Smith (using Morphy C library, by Martin Brazeau)
}
\concept{tree scoring}
