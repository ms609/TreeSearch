% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Concordance.R
\name{ConcordanceTable}
\alias{ConcordanceTable}
\title{Plot concordance table}
\usage{
ConcordanceTable(
  tree,
  dataset,
  Col = QACol,
  largeClade = 0,
  xlab = "Edge",
  ylab = "Character",
  ...
)
}
\arguments{
\item{tree}{A tree of class \code{\link[ape:read.tree]{phylo}}.}

\item{dataset}{A phylogenetic data matrix of \pkg{phangorn} class
\code{phyDat}, whose names correspond to the labels of any accompanying tree.
Perhaps load into R using \code{\link[TreeTools]{ReadAsPhyDat}}.
Additive (ordered) characters can be handled using
\code{\link[TreeTools]{Decompose}}.}

\item{Col}{Function that takes vectors \code{amount} and \code{quality} and returns
a vector of colours.}

\item{largeClade}{Integer; if greater than 1, vertical lines will be drawn
at edges whose descendants are both contain more than \code{largeClade} leaves.}

\item{xlab}{Character giving a label for the x axis.}

\item{ylab}{Character giving a label for the y axis.}

\item{\dots}{Arguments to \code{abline}, to control the appearance of vertical
lines marking important edges.}
}
\value{
\code{ConcordanceTable()} invisibly returns an named list containing:
\itemize{
\item \code{"info"}: The amount of information in each character-edge pair, in bits;
\item \code{"relInfo"}: The information, normalized to the most information-rich pair;
\item \code{"quality"}: The normalized mutual information of the pair;
\item \code{"col"}: The colours used to plot the table.
}
}
\description{
Plot concordance table
}
\examples{
# Load data and tree
data("congreveLamsdellMatrices", package = "TreeSearch")
dataset <- congreveLamsdellMatrices[[1]][, 1:20]
tree <- referenceTree

# Plot tree and identify nodes
library("TreeTools", quietly = TRUE)
plot(tree)
nodeIndex <- as.integer(rownames(as.Splits(tree)))
nodelabels(seq_along(nodeIndex), nodeIndex, adj = c(2, 1),
           frame = "none", bg = NULL)
QALegend(where = c(0.1, 0.4, 0.1, 0.3))

# View information shared by characters and edges
ConcordanceTable(tree, dataset, largeClade = 3, col = 2, lwd = 3)
axis(1)
axis(2)

# Visualize dataset
image(t(`mode<-`(PhyDatToMatrix(dataset), "numeric")), axes = FALSE,
      xlab = "Leaf", ylab = "Character")
}
