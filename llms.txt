# TreeSearch

[![codecov](https://codecov.io/gh/ms609/TreeSearch/branch/master/graph/badge.svg)](https://codecov.io/gh/ms609/TreeSearch)
[![CRAN Status
Badge](http://www.r-pkg.org/badges/version/TreeSearch)](https://cran.r-project.org/package=TreeSearch)
[![CRAN RStudio mirror
downloads](http://cranlogs.r-pkg.org/badges/TreeSearch)](https://ms609.github.io/usage/#treesearch)
[![CRAN RStudio mirror
downloads](http://cranlogs.r-pkg.org/badges/grand-total/TreeSearch)](https://ms609.github.io/usage/#treesearch)
[![DOI](https://zenodo.org/badge/98171642.svg)](https://zenodo.org/badge/latestdoi/98171642)
[![Project Status: Active – – The project has reached a stable, usable
state and is being actively
developed.](http://www.repostatus.org/badges/latest/active.svg)](http://www.repostatus.org/#active)

“TreeSearch” (Smith 2023) is an R package that contains a “shiny” user
interface for interactive tree search and exploration of results,
including character visualization, [rogue taxon
detection](https://ms609.github.io/Rogue) (Smith 2022a), [tree space
mapping](https://ms609.github.io/TreeDist/articles/treespace.html)
(Smith 2022b), and cluster consensus trees.

Inapplicable character states are handled using the algorithm of
Brazeau, Guillerme and Smith (2019) using the “Morphy” C library
(Brazeau *et al*. 2017). Implied weighting (Goloboff, 1993), Profile
Parsimony (Faith and Trueman, 2001) and Successive Approximations
(Farris, 1969) are implemented; [custom optimality
criteria](https://ms609.github.io/TreeSearch/articles/custom.html) and
search approaches can also be defined.

# Installing in R

Full installation instructions, including notes on installing R, are
available in a
[vignette](https://ms609.github.io/TreeSearch/articles/getting-started.html).

Install and load the stable version from CRAN as follows:

``` r
install.packages("TreeSearch")
library("TreeSearch")
# Launch the Shiny App with:
TreeSearch::EasyTrees()
```

Install and load the development version of “TreeSearch” with:

``` r
if(!require("curl")) install.packages("curl")
if(!require("remotes")) install.packages("remotes")
remotes::install_github("ms609/TreeSearch")
library("TreeSearch")
```

# Installing stand-alone application

The TreeSearch user interface can be run as a stand-alone application
without installing R.
[Download](https://github.com/ms609/TreeSearch/releases) the latest
release for your platform. If your preferred platform is not supported,
please contact the maintainer.

## Installation on Windows

You may need to obtain the [ffmpeg
library](https://community.chocolatey.org/packages/ffmpeg) before you
can run TreeSearch.

This is best installed using [‘Chocolatey’](https://chocolatey.org/).

Once chocolatey is installed, open a PowerShell window with
administrative privileges, and type `choco install ffmpeg`; then restart
your computer.

# Quick start

Launch a graphical user interface by typing
[`TreeSearch::EasyTrees()`](https://ms609.github.io/TreeSearch/reference/MaximizeParsimony.md)
in the R console.

For more control over search settings, see
[`?MaximizeParsimony()`](https://ms609.github.io/TreeSearch/reference/MaximizeParsimony.html).

![Flow charts listing common actions facilitated by
TreeSearch](reference/figures/Flow.svg)

Flow charts listing common actions facilitated by TreeSearch

# Documentation

- [Package functions](https://ms609.github.io/TreeSearch/reference)
  reference manual

- [Getting
  started](https://ms609.github.io/TreeSearch/articles/getting-started.html)

- [Using the
  GUI](https://ms609.github.io/TreeSearch/articles/tree-search.html)

- [Analysing tree
  spaces](https://ms609.github.io/TreeSearch/articles/tree-space.html)

- [Loading phylogenetic data into
  R](https://ms609.github.io/TreeTools/articles/load-data.html)

- [Parsimony search with inapplicable
  data](https://ms609.github.io/TreeSearch/articles/tree-search.html)

- [Calculating concavity
  profiles](https://ms609.github.io/TreeSearch/articles/profile-scores.html)
  for Profile Parsimony

- [Tree search with profile
  parsimony](https://ms609.github.io/TreeSearch/articles/profile.html)

‘TreeSearch’ uses [semantic versioning](https://semver.org/). Please
note that the ‘TreeSearch’ project is released with a [Contributor Code
of Conduct](https://ms609.github.io/TreeSearch/CODE_OF_CONDUCT.md). By
contributing to this project, you agree to abide by its terms.

# References

Brazeau M. D., Smith M. R., Guillerme T. (2017). MorphyLib: a library
for phylogenetic analysis of categorical trait data with
inapplicability. doi:
[10.5281/zenodo.815372](https://doi.org/10.5281/zenodo.815372).

Brazeau, M. D., Guillerme, T. and Smith, M. R. (2019). An algorithm for
morphological phylogenetic analysis with inapplicable data. Systematic
Biology, 68(4), 619-631. doi:
[10.1093/sysbio/syy083](https://dx.doi.org/10.1093/sysbio/syy083).

Faith D. P., Trueman J. W. H. (2001). Towards an inclusive philosophy
for phylogenetic inference. Systematic Biology, 50(3), 331–350. doi:
[10.1080/10635150118627](https://dx.doi.org/10.1080/10635150118627).

Farris, J. S. (1969). A successive approximations approach to character
weighting. Systematic Biology, 18(4), 374–385. doi:
[10.2307/2412182](https://dx.doi.org/10.2307/2412182).

Goloboff, P. A. (1993). Estimating character weights during tree search.
Cladistics, 9(1), 83–91. doi:
[10.1111/j.1096-0031.1993.tb00209.x](https://doi.org/10.1111/j.1096-0031.1993.tb00209.x).

Goloboff, P. A., Torres, A., Arias, J. S. (2018). Weighted parsimony
outperforms other methods of phylogenetic inference under models
appropriate for morphology. Cladistics, 34(4), 407–437. doi:
[10.1111/cla.12205](https://doi.org/10.1111/cla.12205).

Smith, M. R. (2022a). Using information theory to detect rogue taxa and
improve phylogenetic trees. Systematic Biology, 71(5), 1088–1094. doi:
[10.1093/sysbio/syab099](https://dx.doi.org/10.1093/sysbio/syab099)

Smith, M. R. (2022b). Robust analysis of phylogenetic tree space.
Systematic Biology, 71(5), 1255–1270. doi:
[10.1093/sysbio/syab100](https://dx.doi.org/10.1093/sysbio/syab100)

Smith, M. R. (2023). TreeSearch: morphological phylogenetic analysis in
R. R Journal, 14(4), 305-315. doi:
[10.32614/RJ-2023-019](https://doi.org/10.32614/RJ-2023-019)

# Package index

## Custom search

Functions to search for optimal phylogenetic trees.

- [`Jackknife()`](https://ms609.github.io/TreeSearch/reference/Jackknife.md)
  : Jackknife resampling
- [`MorphyBootstrap()`](https://ms609.github.io/TreeSearch/reference/Ratchet.md)
  [`Ratchet()`](https://ms609.github.io/TreeSearch/reference/Ratchet.md)
  [`MultiRatchet()`](https://ms609.github.io/TreeSearch/reference/Ratchet.md)
  [`RatchetConsensus()`](https://ms609.github.io/TreeSearch/reference/Ratchet.md)
  : Parsimony Ratchet

## Tree scoring

Functions that provide tree scores, for optimization.

- [`CharacterLength()`](https://ms609.github.io/TreeSearch/reference/CharacterLength.md)
  [`FastCharacterLength()`](https://ms609.github.io/TreeSearch/reference/CharacterLength.md)
  : Character length
- [`ExpectedLength()`](https://ms609.github.io/TreeSearch/reference/ExpectedLength.md)
  : Expected length
- [`LengthAdded()`](https://ms609.github.io/TreeSearch/reference/LengthAdded.md)
  [`PolEscapa()`](https://ms609.github.io/TreeSearch/reference/LengthAdded.md)
  : Contribution of character to leaf instability
- [`MinimumLength()`](https://ms609.github.io/TreeSearch/reference/MinimumLength.md)
  [`MinimumSteps()`](https://ms609.github.io/TreeSearch/reference/MinimumLength.md)
  [`MaximumLength()`](https://ms609.github.io/TreeSearch/reference/MinimumLength.md)
  : Minimum and Maximum lengths possible for a character
- [`TaxonInfluence()`](https://ms609.github.io/TreeSearch/reference/TaxonInfluence.md)
  : Rank taxa by their influence on phylogenetic results
- [`IWScore()`](https://ms609.github.io/TreeSearch/reference/TreeLength.md)
  [`TreeLength()`](https://ms609.github.io/TreeSearch/reference/TreeLength.md)
  [`Fitch()`](https://ms609.github.io/TreeSearch/reference/TreeLength.md)
  : Calculate the parsimony score of a tree given a dataset
- [`ConcordantInformation()`](https://ms609.github.io/TreeSearch/reference/ConcordantInformation.md)
  [`Evaluate()`](https://ms609.github.io/TreeSearch/reference/ConcordantInformation.md)
  [`ConcordantInfo()`](https://ms609.github.io/TreeSearch/reference/ConcordantInformation.md)
  : Evaluate the concordance of information between a tree and a dataset
- [`Consistency()`](https://ms609.github.io/TreeSearch/reference/Consistency.md)
  : Consistency and retention "indices"
- [`PlotCharacter()`](https://ms609.github.io/TreeSearch/reference/PlotCharacter.md)
  : Plot the distribution of a character on a tree
- [`RandomTreeScore()`](https://ms609.github.io/TreeSearch/reference/RandomTreeScore.md)
  : Parsimony score of random postorder tree

## Tree (re)construction

Tree generation and rearrangement functions.

- [`AdditionTree()`](https://ms609.github.io/TreeSearch/reference/AdditionTree.md)
  : Addition tree

- [`RandomMorphyTree()`](https://ms609.github.io/TreeSearch/reference/RandomMorphyTree.md)
  : Random postorder tree

- [`NNI()`](https://ms609.github.io/TreeSearch/reference/NNI.md)
  [`cNNI()`](https://ms609.github.io/TreeSearch/reference/NNI.md)
  [`NNISwap()`](https://ms609.github.io/TreeSearch/reference/NNI.md)
  [`RootedNNI()`](https://ms609.github.io/TreeSearch/reference/NNI.md)
  [`RootedNNISwap()`](https://ms609.github.io/TreeSearch/reference/NNI.md)
  : Nearest neighbour interchange (NNI)

- [`AllSPR()`](https://ms609.github.io/TreeSearch/reference/AllSPR.md) :
  All SPR trees

- [`SPR()`](https://ms609.github.io/TreeSearch/reference/SPR.md)
  [`SPRMoves()`](https://ms609.github.io/TreeSearch/reference/SPR.md)
  [`SPRSwap()`](https://ms609.github.io/TreeSearch/reference/SPR.md)
  [`RootedSPR()`](https://ms609.github.io/TreeSearch/reference/SPR.md)
  [`RootedSPRSwap()`](https://ms609.github.io/TreeSearch/reference/SPR.md)
  : Subtree pruning and rearrangement (SPR)

- [`cSPR()`](https://ms609.github.io/TreeSearch/reference/cSPR.md) :

  [`cSPR()`](https://ms609.github.io/TreeSearch/reference/cSPR.md)
  expects a tree rooted on a single tip.

- [`TBR()`](https://ms609.github.io/TreeSearch/reference/TBR.md)
  [`TBRMoves()`](https://ms609.github.io/TreeSearch/reference/TBR.md)
  [`TBRSwap()`](https://ms609.github.io/TreeSearch/reference/TBR.md)
  [`RootedTBR()`](https://ms609.github.io/TreeSearch/reference/TBR.md)
  [`RootedTBRSwap()`](https://ms609.github.io/TreeSearch/reference/TBR.md)
  : Tree bisection and reconnection (TBR)

- [`RearrangeEdges()`](https://ms609.github.io/TreeSearch/reference/RearrangeEdges.md)
  : Rearrange edges of a phylogenetic tree

## Tree properties

Functions that calculate support for edges.

- [`ConcordanceTable()`](https://ms609.github.io/TreeSearch/reference/ConcordanceTable.md)
  : Plot concordance table
- [`JackLabels()`](https://ms609.github.io/TreeSearch/reference/JackLabels.md)
  : Label nodes with jackknife support values
- [`Jackknife()`](https://ms609.github.io/TreeSearch/reference/Jackknife.md)
  : Jackknife resampling
- [`MaximizeParsimony()`](https://ms609.github.io/TreeSearch/reference/MaximizeParsimony.md)
  [`Resample()`](https://ms609.github.io/TreeSearch/reference/MaximizeParsimony.md)
  [`EasyTrees()`](https://ms609.github.io/TreeSearch/reference/MaximizeParsimony.md)
  [`EasyTreesy()`](https://ms609.github.io/TreeSearch/reference/MaximizeParsimony.md)
  : Find most parsimonious trees
- [`MostContradictedFreq()`](https://ms609.github.io/TreeSearch/reference/MostContradictedFreq.md)
  : Frequency of most common contradictory split
- [`PresCont()`](https://ms609.github.io/TreeSearch/reference/PresCont.md)
  : Group present or contradicted score
- [`ClusteringConcordance()`](https://ms609.github.io/TreeSearch/reference/SiteConcordance.md)
  [`MutualClusteringConcordance()`](https://ms609.github.io/TreeSearch/reference/SiteConcordance.md)
  [`QuartetConcordance()`](https://ms609.github.io/TreeSearch/reference/SiteConcordance.md)
  [`PhylogeneticConcordance()`](https://ms609.github.io/TreeSearch/reference/SiteConcordance.md)
  [`SharedPhylogeneticConcordance()`](https://ms609.github.io/TreeSearch/reference/SiteConcordance.md)
  : Concordance factors

## Profile parsimony

Functions to help calculate profile parsimony scores.

- [`Carter1()`](https://ms609.github.io/TreeSearch/reference/Carter1.md)
  [`Log2Carter1()`](https://ms609.github.io/TreeSearch/reference/Carter1.md)
  [`LogCarter1()`](https://ms609.github.io/TreeSearch/reference/Carter1.md)
  :

  Number of trees with *m* steps

- [`PrepareDataProfile()`](https://ms609.github.io/TreeSearch/reference/PrepareDataProfile.md)
  [`PrepareDataIW()`](https://ms609.github.io/TreeSearch/reference/PrepareDataProfile.md)
  : Prepare data for Profile Parsimony

- [`StepInformation()`](https://ms609.github.io/TreeSearch/reference/StepInformation.md)
  :

  Information content of a character known to contain *e* steps

- [`WithOneExtraStep()`](https://ms609.github.io/TreeSearch/reference/WithOneExtraStep.md)
  : Number of trees with one extra step

- [`profiles`](https://ms609.github.io/TreeSearch/reference/profiles.md)
  : Empirically counted profiles for small trees

## Morphy APIs

Functions that interface with the Morphy C library.

- [`GapHandler()`](https://ms609.github.io/TreeSearch/reference/GapHandler.md)
  : Read how a Morphy Object handles the inapplicable token

- [`MorphyWeights()`](https://ms609.github.io/TreeSearch/reference/MorphyWeights.md)
  [`SetMorphyWeights()`](https://ms609.github.io/TreeSearch/reference/MorphyWeights.md)
  : Set and get the character weightings associated with a Morphy
  object.

- [`PhyDat2Morphy()`](https://ms609.github.io/TreeSearch/reference/PhyDat2Morphy.md)
  :

  Initialize a Morphy object from a `phyDat` object

- [`SingleCharMorphy()`](https://ms609.github.io/TreeSearch/reference/SingleCharMorphy.md)
  : Morphy object from single character

- [`UnloadMorphy()`](https://ms609.github.io/TreeSearch/reference/UnloadMorphy.md)
  : Destroy a Morphy object

- [`is.morphyPtr()`](https://ms609.github.io/TreeSearch/reference/is.morphyPtr.md)
  : Is an object a valid Morphy object?

- [`summary(`*`<morphyPtr>`*`)`](https://ms609.github.io/TreeSearch/reference/summary.morphyPtr.md)
  : Details the attributes of a morphy object

## Datasets

Data that accompanies the package.

- [`congreveLamsdellMatrices`](https://ms609.github.io/TreeSearch/reference/congreveLamsdellMatrices.md)
  : 100 simulated data matrices
- [`inapplicable.datasets`](https://ms609.github.io/TreeSearch/reference/inapplicable.datasets.md)
  [`inapplicable.phyData`](https://ms609.github.io/TreeSearch/reference/inapplicable.datasets.md)
  [`inapplicable.trees`](https://ms609.github.io/TreeSearch/reference/inapplicable.datasets.md)
  [`inapplicable.citations`](https://ms609.github.io/TreeSearch/reference/inapplicable.datasets.md)
  : Thirty datasets with inapplicable data
- [`profiles`](https://ms609.github.io/TreeSearch/reference/profiles.md)
  : Empirically counted profiles for small trees
- [`referenceTree`](https://ms609.github.io/TreeSearch/reference/referenceTree.md)
  : Tree topology for matrix simulation

## Utility functions

Miscellaneous functions used within the package.

- [`ClusterStrings()`](https://ms609.github.io/TreeSearch/reference/ClusterStrings.md)
  : Cluster similar strings
- [`QACol()`](https://ms609.github.io/TreeSearch/reference/QACol.md)
  [`QCol()`](https://ms609.github.io/TreeSearch/reference/QACol.md)
  [`QALegend()`](https://ms609.github.io/TreeSearch/reference/QACol.md)
  : Generate colour to depict the amount and quality of observations
- [`QuartetResolution()`](https://ms609.github.io/TreeSearch/reference/QuartetResolution.md)
  : Relationship between four taxa
- [`WhenFirstHit()`](https://ms609.github.io/TreeSearch/reference/WhenFirstHit.md)
  : When was a tree topology first hit?

# Articles

### Getting started

- [Getting started: Installing R and
  TreeSearch](https://ms609.github.io/TreeSearch/articles/getting-started.md):
- [Getting started: Simple tree
  searches](https://ms609.github.io/TreeSearch/articles/tree-search.md):
- [Getting started: Exploring tree
  space](https://ms609.github.io/TreeSearch/articles/tree-space.md):

### Advanced use

Changing optimality criteria for tree search

- [Profile
  parsimony](https://ms609.github.io/TreeSearch/articles/profile-scores.md):
- [Tree search with Profile
  parsimony](https://ms609.github.io/TreeSearch/articles/profile.md):
- [Tree search with custom optimality
  criteria](https://ms609.github.io/TreeSearch/articles/custom.md):
