<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Rank taxa by their influence on phylogenetic results — TaxonInfluence • TreeSearch</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous"><link href="../docsearch.css" rel="stylesheet"><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Rank taxa by their influence on phylogenetic results — TaxonInfluence"><meta property="og:description" content="TaxonInfluence() ranks taxa according to their influence on the most
parsimonious topology."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-V9DV1LS35J"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-V9DV1LS35J');
</script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">TreeSearch</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.4.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li class="divider">
    <li class="dropdown-header">Getting started</li>
    <li>
      <a href="../articles/getting-started.html">Getting started: Installing R and TreeSearch</a>
    </li>
    <li>
      <a href="../articles/tree-search.html">Getting started: Simple tree searches</a>
    </li>
    <li>
      <a href="../articles/tree-space.html">Getting started: Exploring tree space</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Advanced use</li>
    <li>
      <a href="../articles/profile-scores.html">Profile parsimony</a>
    </li>
    <li>
      <a href="../articles/profile.html">Tree search with Profile parsimony</a>
    </li>
    <li>
      <a href="../articles/custom.html">Tree search with custom optimality criteria</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/ms609/TreeSearch/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul><form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off"></div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Rank taxa by their influence on phylogenetic results</h1>
    <small class="dont-index">Source: <a href="https://github.com/ms609/TreeSearch/blob/HEAD/R/TaxonInfluence.R" class="external-link"><code>R/TaxonInfluence.R</code></a></small>
    <div class="hidden name"><code>TaxonInfluence.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>TaxonInfluence()</code> ranks taxa according to their influence on the most
parsimonious topology.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">TaxonInfluence</span><span class="op">(</span></span>
<span>  <span class="va">dataset</span>,</span>
<span>  tree <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Distance <span class="op">=</span> <span class="va">ClusteringInfoDistance</span>,</span>
<span>  calcWeighted <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  savePath <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  useCache <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbosity <span class="op">=</span> <span class="fl">3L</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>dataset</dt>
<dd><p>A phylogenetic data matrix of <span class="pkg">phangorn</span> class
<code>phyDat</code>, whose names correspond to the labels of any accompanying tree.</p></dd>


<dt>tree</dt>
<dd><p>Optimal tree or summary tree (of class "phylo") or list of trees
(of class "list" or "multiPhylo") against which results should be evaluated.
If <code>NULL</code>, an optimal tree will be sought using parsimony search with
the parameters provided in <code>...</code>.</p></dd>


<dt>Distance</dt>
<dd><p>Function to calculate tree distance; default:
<code>ClusteringInfoDistance()</code>.</p></dd>


<dt>calcWeighted</dt>
<dd><p>Logical specifying whether to compute the
distance-weighted mean value.</p></dd>


<dt>savePath</dt>
<dd><p>Character giving prefix of path to which reduced trees will be
saved (with <code><a href="https://rdrr.io/pkg/ape/man/write.nexus.html" class="external-link">write.nexus()</a></code>). File names will follow the pattern
<code>paste0(savePath, droppedTaxonName, ".nex")</code>; <code>savePath</code> should thus contain
a trailing <code>/</code> if writing to a directory, which will be created if it does
not exist.  Special characters will be removed from leaf labels when
creating the file path (using <code>path_sanitize()</code>).
If <code>NULL</code>, computed trees will not be saved.</p></dd>


<dt>useCache</dt>
<dd><p>Logical vector; if <code>TRUE</code>, previous tree search results will
be loaded from the location given by <code>savePath</code>, instead of running a fresh
search with the specified dataset and parameters.</p></dd>


<dt>verbosity, ...</dt>
<dd><p>Parameters for <code><a href="MaximizeParsimony.html">MaximizeParsimony()</a></code>.
Tree search will be conducted using <code>tree</code> as a starting tree.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p><code>TaxonInfluence()</code> returns a matrix listing the phylogenetic
influence of each taxon, measured in the units of the chosen tree distance
metric (default = bits).
Columns denote taxa; rows denote the maximum, distance-weighted mean,
and minimum distance between optimal tree sets.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p><code>TaxonInfluence()</code> follows the approach of
Mariadassou et al. (2012)
 in repeating tree search
whilst leaving each taxon in turn out of the analysis, and measuring
the distance of reconstructed trees from the optimal tree obtained when
all taxa are included in phylogenetic inference.</p>
<p>As Denton and Goolsby (2018)
 emphasize, the
Robinson–Foulds distance is unsuitable for this purpose; this function
allows the user to specify a preferred tree distance measure, defaulting
to the clustering information distance (Smith 2020)
.
Because optimal parsimony trees are not equiprobable, taxon influence is
ranked based on the maximum and minimum tree-to-tree distances between
optimal trees.</p>
    </div>
    <div id="distance-weighted-mean">
    <h2>Distance-weighted mean</h2>
    

<p>Sets of equally parsimonious trees are not statistical samples of tree space,
but are biased towards areas of uncertainty.
It is possible that a set of trees contains all possible resolutions of a
particular clade, and a single other topology in which that clade does not
exist – essentially two distinct solutions, one (<em>a</em>) which could be
summarised with a summary tree that contains a polytomy, and another (<em>b</em>)
which could be summarized by a perfectly resolved tree.
Neither of these scenarios is preferable under the principles of parsimony;
but summary statistics (e.g. mean, median) will be strongly influenced by the
many trees in group <em>a</em>, thus underplaying the existence of solution <em>b</em>.</p>
<p><code>TaxonInfluence()</code> uses an <em>ad hoc</em> method to produce summary statistics
after weighting for trees' distance from other trees.  Trees that have few
close neighbours contribute more to the weighted mean, thus reducing the
influence of many trees that differ only in small details.
This distance-weighted mean is thus less prone to bias than a simple mean
– it is no more statistically valid, but (potentially) provides a more
representative summary of comparisons between sets of trees.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Denton JS, Goolsby EW (2018).
“Measuring Inferential Importance of Taxa Using Taxon Influence Indices.”
<em>Ecology and Evolution</em>, <b>8</b>(9), 4484--4494.
<a href="https://doi.org/10.1002/ece3.3941" class="external-link">doi:10.1002/ece3.3941</a>
.<br><br> Mariadassou M, Bar-Hen A, Kishino H (2012).
“Taxon Influence Index: Assessing Taxon-Induced Incongruities in Phylogenetic Inference.”
<em>Systematic Biology</em>, <b>61</b>(2), 337--345.
<a href="https://doi.org/10.1093/sysbio/syr129" class="external-link">doi:10.1093/sysbio/syr129</a>
.<br><br> Smith MR (2020).
“Information Theoretic Generalized Robinson-Foulds Metrics for Comparing Phylogenetic Trees.”
<em>Bioinformatics</em>, <b>36</b>(20), 5007--5013.
<a href="https://doi.org/10.1093/bioinformatics/btaa614" class="external-link">doi:10.1093/bioinformatics/btaa614</a>
.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Other tree scoring: 
<code><a href="CharacterLength.html">CharacterLength</a>()</code>,
<code><a href="TreeLength.html">IWScore</a>()</code>,
<code><a href="LengthAdded.html">LengthAdded</a>()</code>,
<code><a href="MinimumLength.html">MinimumLength</a>()</code>,
<code><a href="MorphyTreeLength.html">MorphyTreeLength</a>()</code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p><a href="https://smithlabdurham.github.io/" class="external-link">Martin R. Smith</a>
(<a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a>)</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">#' # Load data for analysis in R</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://ms609.github.io/TreeTools/" class="external-link">"TreeTools"</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"congreveLamsdellMatrices"</span>, package <span class="op">=</span> <span class="st">"TreeSearch"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Small dataset for demonstration purposes</span></span></span>
<span class="r-in"><span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="va">congreveLamsdellMatrices</span><span class="op">[[</span><span class="fl">42</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">bestTree</span> <span class="op">&lt;-</span> <span class="fu"><a href="MaximizeParsimony.html">MaximizeParsimony</a></span><span class="op">(</span><span class="va">dataset</span>, verbosity <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate tip influence</span></span></span>
<span class="r-in"><span><span class="va">influence</span> <span class="op">&lt;-</span> <span class="fu">TaxonInfluence</span><span class="op">(</span><span class="va">dataset</span>, ratchIt <span class="op">=</span> <span class="fl">0</span>, startIt <span class="op">=</span> <span class="fl">0</span>, verbos <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">BEGIN TREE SEARCH (k = Inf)</span> <span style="color: #00BBBB;">─────────────────────────────────────────────────</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → Initial score: <span style="font-weight: bold;">86 </span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Sample local optimum</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → TBR depth 2; keeping 14.4 trees; k = Inf</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> 2024-04-02 10:59:41: Score: 86</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> 2024-04-02 10:59:41: Tree search terminated with score <span style="font-weight: bold;">82</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Colour tip labels according to their influence</span></span></span>
<span class="r-in"><span><span class="va">upperBound</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">*</span> <span class="fu">TreeDist</span><span class="fu">::</span><span class="fu"><a href="https://ms609.github.io/TreeDist/reference/TreeInfo.html" class="external-link">ClusteringEntropy</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ms609.github.io/TreeTools/reference/GenerateTree.html" class="external-link">PectinateTree</a></span><span class="op">(</span><span class="fu"><a href="https://ms609.github.io/TreeTools/reference/NTip.html" class="external-link">NTip</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">nBin</span> <span class="op">&lt;-</span> <span class="fl">128</span></span></span>
<span class="r-in"><span><span class="va">bin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">influence</span><span class="op">[</span><span class="st">"max"</span>, <span class="op">]</span>,</span></span>
<span class="r-in"><span>  breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">upperBound</span>, length.out <span class="op">=</span> <span class="va">nBin</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  include.lowest <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">palette</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">hcl.colors</a></span><span class="op">(</span><span class="va">nBin</span>, <span class="st">"inferno"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">bestTree</span>, tip.color <span class="op">=</span> <span class="va">palette</span><span class="op">[</span><span class="va">bin</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">PlotTools</span><span class="fu">::</span><span class="fu"><a href="https://ms609.github.io/PlotTools/reference/SpectrumLegend.html" class="external-link">SpectrumLegend</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="st">"bottomleft"</span>,</span></span>
<span class="r-in"><span>  palette <span class="op">=</span> <span class="va">palette</span>,</span></span>
<span class="r-in"><span>  title <span class="op">=</span> <span class="st">"Tip influence / bits"</span>,</span></span>
<span class="r-in"><span>  legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">signif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">upperBound</span>, <span class="fl">0</span>, length.out <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  bty <span class="op">=</span> <span class="st">"n"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="TaxonInfluence-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="https://smithlabdurham.github.io/" class="external-link">Martin R. Smith</a>.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '8422cbc6478f9d3278ad355b48435342',
    indexName: 'treesearch',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script></body></html>

